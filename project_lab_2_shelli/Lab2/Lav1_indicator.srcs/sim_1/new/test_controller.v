`timescale 1ns / 1ps

module test_controller;

// Параметры и сигналы для тестирования
reg clk;
reg [15:0] SWITCHES;
reg btn_c;
reg [15:0] dataIn;
wire [15:0] dataOut;
wire [6:0] SEG;
wire [7:0] AN;

// Экземпляр тестируемого модуля
Controller uut (
    .clk(clk),
    .SWITCHES(SWITCHES),
    .btn_c(btn_c),
    .SEG(SEG),
    .AN(AN),
    .dataOut(dataOut)
);

// Генерация тактового сигнала
initial begin
    clk = 0;
    forever #5 clk = ~clk;
end

// Процедура для тестирования
initial begin
    // Инициализация
    btn_c = 0;
    SWITCHES = 16'b0;

    // Задержка для начальной инициализации
    #100;

    // Тест 1: Ввод размера массива
    SWITCHES = 16'd4;  // Размер массива - 4 элемента
    btn_c = 1; #10; btn_c = 0; // Нажатие кнопки

    // Задержка для FSM
    #50;

    // Тест 2: Ввод элементов массива
    SWITCHES = 16'd15; // Первый элемент массива
    btn_c = 1; #10; btn_c = 0; // Нажатие кнопки
    #20;

    SWITCHES = 16'd10; // Второй элемент массива
    btn_c = 1; #10; btn_c = 0; // Нажатие кнопки
    #20;

    SWITCHES = 16'd20; // Третий элемент массива
    btn_c = 1; #10; btn_c = 0; // Нажатие кнопки
    #20;

    SWITCHES = 16'd5;  // Четвертый элемент массива
    btn_c = 1; #10; btn_c = 0; // Нажатие кнопки
    #20;

    // Задержка для завершения ввода массива и начала сортировки
    #1000;

    // Тест 3: Проверка вывода отсортированного массива
    // Сортированный массив должен быть: 5, 10, 15, 20
    btn_c = 1; #10; btn_c = 0; // Нажатие кнопки для вывода первого элемента
    #20;
    $display("Output: %d", uut.dataOut); // Ожидается 5

    btn_c = 1; #10; btn_c = 0; // Нажатие кнопки для вывода второго элемента
    #20;
    $display("Output: %d", uut.dataOut); // Ожидается 10

    btn_c = 1; #10; btn_c = 0; // Нажатие кнопки для вывода третьего элемента
    #20;
    $display("Output: %d", uut.dataOut); // Ожидается 15

    btn_c = 1; #10; btn_c = 0; // Нажатие кнопки для вывода четвертого элемента
    #20;
    $display("Output: %d", uut.dataOut); // Ожидается 20

    // Завершение симуляции
    #100;
    $finish;
end

endmodule
